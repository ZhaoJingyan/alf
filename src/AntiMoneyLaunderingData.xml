<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
           "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.alf.dao.AntiMoneyLaunderingDataMessage">

	<resultMap type="com.alf.bean.AntiMoneyLaunderingData" id="amldMap">
	  <result column="jyrq" javaType="java.util.Date" jdbcType="DATE" property="jyrq"/>
	  <result column="jysj" jdbcType="CHAR" property="jysj"/>
	  <result column="jyjg" jdbcType="CHAR" property="jyjg"/>
	  <result column="jylsh" jdbcType="CHAR" property="jylsh"/>
	  <result column="flxh" jdbcType="CHAR" property="flxh"/>
	</resultMap>

	<select id="getAntiMoneyLaunderingDatasBy" parameterType="Date" resultMap="amldMap">
( 
	select 'wzj' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.fkrzh as THZH,wz.FKR as THHM, wz.TCH as BHJG,wz.tchm as BHMC,wz.TRH as THJM,wz.TRHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx
	  from tc_yw_pjdjb wz 
	        left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' 
	        left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
	   where  hx.jym not in ('020045','020047') 
	   and (wz.hxzt='1') 
	   and wz.JDBS='1' 
	   and wz.djblx='ssywwz' 
	   and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union (
	select 'wzd' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.skrzh as THZH,wz.SKR as THHM, wz.TCH as BHJG,wz.tchm as BHMC,wz.TRH as THJM,wz.TRHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx
	from tc_yw_pjdjb wz 
	      left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' 
	      left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
	where hx.jym not in ('020045','020047') 
      and (wz.hxzt='1') 
      and wz.JDBS='2' 
      and wz.djblx='ssywwz' 
      and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union ( 
	select 'lzj' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.skrzh as THZH,wz.SKR as THHM, wz.TRH as BHJG,wz.trhm as BHMC,wz.TCH as THJM,wz.TCHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx 
	from tc_yw_pjdjb wz 
	      left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' 
	      left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
   where hx.jym not in ('020045','020047') and (wz.hxzt='1') and wz.JDBS='1' and wz.djblx='ssywlz' 
      and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union ( 
	select 'lzd' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.fkrzh as THZH,wz.FKR as THHM, wz.TRH as BHJG,wz.trhm as BHMC,wz.TCH as THJM,wz.TCHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx 
	from tc_yw_pjdjb wz 
	      left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
	where  hx.jym not in ('020045','020047') and (wz.hxzt='1') and wz.djblx='ssywlz' and wz.JDBS='2'  
	    and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union ( 
	select 'wtj' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.fkrzh as THZH,wz.FKR as THHM, wz.TCH as BHJG,wz.tchm as BHMC,wz.TRH as THJM,wz.TRHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx 
	from tc_yw_pjdjb wz
	      left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' 
	      left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
	where  hx.jym not in ('020045','020047') and (wz.hxzt='1') and wz.djblx='tpywwz' and wz.JDBS='1' 
	  and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union (
	select 'wtd' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM, wz.skrzh as THZH,wz.SKR as THHM, wz.TCH as BHJG,wz.tchm as BHMC,wz.TRH as THJM,wz.TRHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx 
	from tc_yw_pjdjb wz 
	      left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' 
	      left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
    where hx.jym not in ('020045','020047') and (wz.hxzt='1') and wz.JDBS='2' and wz.djblx='tpywwz' 
    and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union ( 
    select 'ltj' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.skrzh as THZH,wz.SKR as THHM, wz.TRH as BHJG,wz.trhm as BHMC,wz.TCH as THJM,wz.TCHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx 
    from tc_yw_pjdjb wz left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
    where  hx.jym not in ('020045','020047') and (wz.hxzt='1') and wz.JDBS='1' and wz.djblx='tpywlz' 
    and wz.HXRQ =  #{_parameter,jdbcType=DATE}
) union ( 
    select 'ltd' as ywlx ,wz.YWLS as YWLS,wz.HXRQ as HXRQ,hx.JZSJ as JYSJ,wz.CZJG as JYJG,hx.wwh as HXLS, wz.xzh AS BHZH,wz.xzhm as BHHM,wz.fkrzh as THZH,wz.FKR as THHM, wz.TRH as BHJG,wz.trhm as BHMC,wz.TCH as THJM,wz.TCHM as THMC, wz.BZ,wz.JE,wz.ZKH,wz.zy,NOTEDES.des as PZLX ,wz.jdbs ,wz.zy,wz.bhpzlx as bhpzlx
    from tc_yw_pjdjb wz left outer join HXJYRZ  hx on hx.YWLS = wz.ywls and hx.XYM='08' and hx.jylx='0' left outer join TC_TRANSNOTE NOTEDES on NOTEDES.id = wz.TCPZLX 
    where  hx.jym not in ('020045','020047') and (wz.hxzt='1' ) and wz.djblx='tpywlz' and wz.JDBS='2'  
    and wz.HXRQ =  #{_parameter,jdbcType=DATE}
)
	</select>
	
	<select id="getAllAntiMoneyLaunderingDatas" resultMap="amldMap">
		  select JYRQ
	        ,JYSJ
	        ,JYJG
	        ,JYLSH
	        ,FLXH
	    from test
	</select>
	
	<insert id="addAntiMoneyLaunderingData" parameterType="com.alf.bean.AntiMoneyLaunderingData">
	  insert into test(
	    JYRQ,
	    JYSJ,
	    JYJG,
	    JYLSH,
	    FLXH
	  ) values (
	    #{jyrq,jdbcType=DATE},
	    #{jysj,jdbcType=CHAR},
	    #{jyjg,jdbcType=CHAR},
	    #{jylsh,jdbcType=CHAR},
	    #{flxh,jdbcType=CHAR}
	  )
	</insert>
</mapper>